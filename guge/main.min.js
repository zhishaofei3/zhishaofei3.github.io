var __reflect=this&&this.__reflect||function(e,t,o){e.__class__=t,o?o.push(t):o=[t],e.__types__=e.__types__?o.concat(e.__types__):o},__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function s(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(s.prototype=o.prototype,new s)}}(),LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.setProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(e){function t(){var t=e.call(this)||this;return t.mouseX=0,t.mouseY=0,t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){egret.lifecycle.addLifecycleListener(function(e){e.onUpdate=function(){}}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/ziyuan.res.json","resource/")},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},t.prototype.onResourceLoadComplete=function(e){"preload"==e.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){"preload"==e.groupName&&this.loadingView.setProgress(e.itemsLoaded,e.itemsTotal)},t.prototype.createGameScene=function(){console.log("@我了");var e=RES.getRes("Bicycle_1_ske"),t=RES.getRes("Bicycle_1_tex_json"),o=RES.getRes("Bicycle_1_tex_png"),s=dragonBones.EgretFactory.factory;s.parseDragonBonesData(e),s.parseTextureAtlasData(t,o),this.armatureDisplay=s.buildArmatureDisplay("Bicycle"),this.armatureDisplay.x=500,this.armatureDisplay.y=800,this.armatureDisplay.scaleX=.3,this.armatureDisplay.scaleY=.3,this.armatureDisplay.animation.play("bicycle",1),this.addChild(this.armatureDisplay),this.bone2=this.armatureDisplay.armature.getBone("bone2"),this.bone3=this.armatureDisplay.armature.getBone("bone3"),this.addEventListener(egret.Event.ENTER_FRAME,this.updateBones,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this)},t.prototype.onTouchMove=function(e){this.mouseX=e.stageX-this.armatureDisplay.x-this.bone2.origin.x,this.mouseY=e.stageY-this.armatureDisplay.y-this.bone2.origin.y,console.log("改变了",this.mouseX,this.mouseY)},t.prototype.updateBones=function(){console.log(this.mouseX),this.bone2.offset.x=-this.mouseX,this.bone2.offset.y=this.mouseY,this.bone3.offset.x=-this.mouseX,this.bone3.offset.y=this.mouseY,this.bone2.invalidUpdate(),this.bone3.invalidUpdate()},t.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,o=RES.getRes(e);return t.texture=o,t},t}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");